{% extends 'base.html.twig' %}

{% block title %}Filument Foundry: Admin{% endblock %}

{% block body %}
    <div class="flex-1 flex flex-col bg-[#f5ede5]">
        <main class="p-6 space-y-6">
            <!-- Header -->
            <div class="flex justify-between items-center">
                <!-- Left side: Title + Subtitle -->
                <div class="space-y-1">
                    <h1 class="text-3xl font-extrabold text-gray-900">Materials Management</h1>
                    <p class="text-gray-600 text-base">Manage 3D printing materials catalog</p>
                </div>

                <!-- Right side: Button -->
                <button id="button_modal_addMaterials"
                        style="background-color: #1E1E18;"
                        class="text-white px-4 py-2 rounded-lg flex items-center hover:bg-gray-800 #3C3C30 transition gap-2">
                    <img src="{{ asset('images/admin/Plus.svg') }}" alt="Add Icon" class="w-4 h-4">
                    Add Material
                </button>
            </div>

            <!-- Search-->
            <div class="flex items-center justify-between mt-4 gap-3">
                <!-- Search Input -->
                <div class="flex items-center bg-white px-4 py-2 rounded-xl shadow w-full">
                    <img src="{{ asset('images/partials/search.svg') }}"
                        alt="Orders Icon"
                        style="width: 20px; height: 20px; margin-right: 20px;">
                    <input id="searchInput_materials" type="text" placeholder="Search material..."
                        placeholder="Search orders..."
                        class="w-full focus:outline-none text-gray-700" />
                </div>

                {# SEARCH #}
                <div class="relative inline-block">
                    <!-- Status Filter -->
                    <select 
                        id="availabilityFilter_materials"
                        class="ml-4 bg-white px-4 py-2 rounded-xl shadow text-gray-700 appearance-none" style="padding-right: 3rem;"
                    > 
                        <option value="all" >All Availability</option>
                        <option value="available" >Available</option>
                        <option value="unavailable" >Unavailable</option>
                    </select>
                    <!-- Custom arrow -->
                    <div style="pointer-events: none; position: absolute; top: 0; bottom: 0; right: 0.5rem; display: flex; align-items: center;">
                        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>
                </div>
            </div>

            {# https://chatgpt.com/c/68ea6fe0-1328-8323-90f7-af2f3d12e8ea #}
            <!-- Materials Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-4 gap-6 mt-6">
                {# Loop #}
                {% for material in materials %}
                <div class="bg-white rounded-2xl shadow overflow-hidden flex flex-col material-card_materials"
                        data-name_materials="{{ material.name|lower }}"
                        data-details_materials="{{ material.details|lower }}"
                        data-properties_materials="{{ material.properties|lower }}"
                        data-price_materials="{{ material.price }}"
                >
                    <div class="relative h-48 w-full">
                        <!-- Badge -->
                        {% if material.availability %}
                            <span class="absolute top-4 right-4 bg-[rgb(251,165,3)] text-black text-sm font-semibold px-2 py-1 rounded-md shadow-md">Available</span>
                        {% else %}
                            <span class="absolute top-4 right-4 bg-gray-400 text-white text-sm font-semibold px-2 py-1 rounded-md shadow-md">Unavailable</span>
                        {% endif %}

                        <!-- Image -->
                        <img
                            src="{{ asset(material.imagePath ?? 'uploads/placeholder.jpeg') }}"
                            alt="{{ material.name }}"
                            class="w-full h-full object-cover transition-transform duration-500 hover:scale-105"
                        />
                    </div>
                    <!-- Card Body -->
                    <div class="p-4 flex flex-col flex-1">
                        <div class="flex flex-col space-y-3">
                            <div class="space-y-6">
                                <div class="flex items-start justify-between">
                                    <div>
                                        <h3 class="text-lg font-semibold">{{ material.name }}</h3>
                                        <p class="text-gray-500 text-sm">{{ material.details }}</p>
                                    </div>
                                    <div>
                                        <p class="text-sky-600 font-bold text-lg mt-1">â‚±{{ material.price|number_format(2, '.', ',') }}</p>
                                    </div>
                                </div>

                                <div class="flex flex-wrap gap-2 mt-6">
                                    {% for property in material.properties|split(',') %}
                                        <span class="text-black text-xs px-3 py-1 rounded-xl border border-gray-300">
                                            {{ property|trim }}
                                        </span>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <!-- Footer Controls -->
                        <div class="flex gap-2 pt-6 justify-end">
                            <!-- EDIT BUTTON -->
                            <button
                                type="button"
                                class="editMaterialBtn border border-gray-400 px-2 py-2 rounded-xl font-medium flex items-center gap-2 text-black
                                    bg-[#f5ede5] hover:bg-[rgb(251,165,3)] transition-colors"
                                data-id="{{ material.id }}"
                                data-name="{{ material.name }}"
                                data-details="{{ material.details }}"
                                data-price="{{ material.price }}"
                                data-properties="{{ material.properties }}"
                                data-availability="{{ material.availability ? '1' : '0' }}"
                                data-image="{{ material.imagePath ? asset(material.imagePath) : '' }}"
                            >
                                <img src="{{ asset('images/admin/edit.svg') }}" alt="Edit Icon" class="w-4 h-4">
                            </button>

                            <!-- DELETE BUTTON -->
                            <button
                                type="button"
                                class="deleteMaterialBtn border border-gray-400 px-2 py-2 rounded-xl font-medium flex items-center gap-2 text-black
                                    bg-[#f5ede5] hover:bg-[rgb(251,165,3)] transition-colors"
                                data-delete-url="{{ path('management_delete_material', { id: material.id }) }}"
                                data-material-name="{{ material.name }}"
                            >
                                <img src="{{ asset('images/admin/trash 2.svg') }}" alt="Trash Icon" class="w-4 h-4">
                            </button>
                        </div>
                    </div>
                </div>
                {% else %}
                    <p class="text-gray-500">No materials found.</p>
                {% endfor %}
            </div>

        </main>
    </div>
</div> <!-- NABILIN NA CLOSE FOR LEFT SIDEBAR -->
{% endblock %}